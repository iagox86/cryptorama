<p>
  Great, it looks like you have some working JSON! Now we just have to
  re-encrypt it using Dr. Z's key.
</p>

<p>
  When you're ready, submit a valid, encrypted, and signed message below, same
  format as Level 6. In hex, of course.
</p>

<%=
  erb(:hint, locals: {
    hint_name: "Hint",
    hint: "Your solution from Level 5 will help a lot!"
  })
%>

<%=
  erb(:hint, locals: {
    hint_name: "Hint",
    hint: "Your solution from Level 6 will also help a lot!"
  })
%>

<%=
  erb(:hint, locals: {
    hint_name: "Hint",
    hint: "<a href='https://github.com/iagox86/poracle'>poracle</a> has an encrypt() function, too!"
  })
%>

<div class='level level7 rounded'>
  <%= erb(:message_box, :locals => { completed: completed, messages: messages, errors: errors }) %>

  <form method='GET'>
    <input type='hidden' name='action' value='decrypt' />
    <input type='hidden' name='token' value='<%= token %>' />
    <p>Encrypted + signed data <textarea name='encrypted' id='encrypted'><%= encrypted %></textarea></p>
    <p><input type='submit' value='Save' /></p>
  </form>
  <form method='GET'>
    <input type='hidden' name='action' value='reset' />
    <p><input type='submit' value='Reset (changes the key for levels 5, 6, and 7!)' /></p>
  </form>
</div>

<div class='answer'>
  <p>What is code you get for submitting your answer?</p>

  <%= erb :answer %>
</div>
